---
import Layout from "../layouts/Layout.astro";

import { Image, getImage } from 'astro:assets';

import Button from "../components/Button.astro";
import Navigation from "../components/Navigation.astro";
import Footer from "../components/Footer.astro";

import Modal from "../components/Modal.astro";

import salesStatue from '/src/img/statue-sales.png';
import personalStatus from '/src/img/statue-pa.png';

import ArrowCircle from '/src/img/icons/arrow-circle.svg?raw';
import ArrowCircleDark from '/src/img/icons/arrow-circle-dark.svg';

import taxiSticker from "/src/img/stickers/taxi.png";
import calendarSticker from "/src/img/stickers/calendar.png";
import formSticker from "/src/img/stickers/form.png";
import emailSticker from "/src/img/stickers/email-notif.png";
import messagesSticker from "/src/img/stickers/messages.png";
import campaignSticker from "/src/img/stickers/campaign.png";
import receiptSticker from "/src/img/stickers/receipt.png";
import mapSticker from '/src/img/stickers/map.png';
import searchSticker from '/src/img/stickers/search.png';
import crmSticker from '/src/img/stickers/crm.png';

import featureSticker1 from '/src/img/stickers/feature1.png';
import featureSticker2 from '/src/img/stickers/feature2.png';
import featureSticker3 from '/src/img/stickers/feature3.png';
import featureSticker4 from '/src/img/stickers/feature4.png';

import ChatCarousel from '../components/ChatCarousel.astro';

import agentPink from '/src/img/chats/pink.png';
import agentWren from '/src/img/chats/wren.png';
import agentTaffy from '/src/img/chats/taffy.png';
import agentSoph from '/src/img/chats/soph.png';
import agentLark from '/src/img/chats/lark.png';

import avatarPink from '/src/img/chats/agentBen.png';
import avatarWren from '/src/img/chats/agentChris.png';
import avatarTaffy from '/src/img/chats/agentAlex.png';
import avatarSoph from '/src/img/chats/agentCharlie.png';
import avatarLark from '/src/img/chats/agentPPP.png';

const slides = [
{
id: "pink-1",
heroChip: "Owning meeting planning, every day",
nameChip: "Pink, Ben’s Personal Assistant",
characterSrc: agentPink.src,
characterAlt: "Pink character",
avatarSrc: avatarPink.src,
bubbles: [
{ text: "Check calendar preferences", side: "left", tone: "info", role: "assistant", stickerSrc: calendarSticker.src, stickerAlt: "Calendar sticker" },
{ text: "Ok, Marcus Brody has confirmed availability on Wednesday at either 14:00 or 15:00. I’ll create and send the invite for 14:00 based on your preferences.", side: "left", role: "assistant" },
{ text: "I’ve sent the email to Marcus Brody to include Thursday Jan 22nd alongside Friday and Wednesday options - French time.", side: "left", role: "assistant" },
{ text: "Marcus has accepted the meeting invite for Wednesday, January 28th at 14:00 GMT. The calendar invite has been sent with your Zoom link.\n\nThe meeting is confirmed for 30 minutes during the VentureCap summit - you mentioned you can step away from some events that day, so this should work well.", side: "left", role: "assistant" },
{ text: "Meeting booked!", side: "left", role: "assistant", stickerSrc: taxiSticker.src, stickerAlt: "Taxi sticker" }
]
},
{
id: "wren-1",
heroChip: "Your second brain for all admin",
nameChip: "Wren, Chris’s Personal Assistant",
characterSrc: agentWren.src,
characterAlt: "Wren character",
avatarSrc: avatarWren.src,
bubbles: [
{ text: "You’ve had an email from Calton Primary School about Drama Club. I’ve scanned the form and it’s £40 a term, and starts at 15:30. Would Charlotte like to attend? ", side: "left", role: "assistant", stickerSrc: emailSticker.src, stickerAlt: "Email sticker", className: 'wren' },
{ text: "Yes please, she'd love that", side: "right", role: "user", className: 'user' },
{ text: "Great, I’ve filled in the form and drafted an email. I’ve assumed you’d be ok to pick Charlotte up as it finishes at 17:00 - your calendar is free at that time.", side: "left", role: "assistant", className: 'wren' },
{ text: "That’s the form sent over. The club has sent over a payment link, I can get one of my team to process using your saved card.", side: "left", role: "assistant", className: 'wren' },
{ text: "Admin handled!", side: "left", role: "assistant", className: 'wren', stickerSrc: formSticker.src, stickerAlt: "Form sticker"  }
]
},
{
id: "taffy-1",
heroChip: "Taking charge of campaigns",
nameChip: "Taffy, Alex's Sales Manager",
characterSrc: agentTaffy.src,
characterAlt: "Taffy character",
avatarSrc: avatarTaffy.src,
bubbles: [
{ text: "Create Campaign Message Sequence", side: "left", tone: "info", role: "assistant", stickerSrc: messagesSticker.src, stickerAlt: "Message sticker", className: 'taffy' },
{ text: "Do you have specific wording in mind for these emails, or would you like me to help structure the sequence and messaging for you?", side: "left", role: "assistant", className: 'taffy' },
{ text: "Help structure the sequence and messaging", side: "right", role: "user", className: 'user' },
{ text: "I'll help you structure a solid 5-7 email sequence for reaching decision makers at these speciality retailers about product samples.  I need a few product details from you first.", side: "left", role: "assistant", className: 'taffy' },
{ text: "Can you search online for our product details for me?", side: "right", role: "user", className: 'user' },
{ text: "I've done some digging on your brand and found everything I need to structure a strong email sequence for you.", side: "left", role: "assistant", className: 'taffy'},
{ text: "Message sequence created!", side: "left", role: "assistant", className: 'taffy', stickerSrc: campaignSticker.src, stickerAlt: "Campaign sticker", }
]
},
{
id: "venn-1",
heroChip: "Saving you hours every day",
nameChip: "Soph, Charlie's Personal Assistant",
characterSrc: agentSoph.src,
characterAlt: "Soph character",
avatarSrc: avatarSoph.src,
bubbles: [
{ text: "Go through my inbox and find every VC I’ve spoken to. Add them to a list with their current firm", side: "right", role: "user", stickerSrc: searchSticker.src, stickerAlt: "Search sticker", className: 'soph' },
{ text: "Searching emails, Create ProSheet", tone: "info", side: "left", role: "assistant", className: 'soph' },
{ text: "Done, I’ve found 233 contacts and added their up to date details.", side: "left", role: "assistant", className: 'soph' },
{ text: "Okay, great. Now rank them based on recent statements about AI personal assistants.", side: "right", role: "user", className: 'user' },
{ text: "Done. There are 18 who are 10/10. Want me to reach out?", side: "left", role: "assistant", className: 'soph'},
{ text: "18 Emails drafted", side: "left", role: "assistant", tone: "info", className: 'soph' },
{ text: "CRM updated", side: "left", role: "assistant", className: 'soph', stickerSrc: receiptSticker.src, stickerAlt: "Receipt sticker", }
]
},{
id: "lark-1",
heroChip: "Handling your travel headaches",
nameChip: "Lark, Philipp's Personal Assistant",
characterSrc: agentLark.src,
characterAlt: "Lark character",
avatarSrc: avatarLark.src,
bubbles: [
{ text: "Get quotes for a taxi transfer for my trip next week", side: "right", role: "user", stickerSrc: mapSticker.src, stickerAlt: "Map sticker", className: 'lark' },
{ text: "Welcome Pickups has given a booking link at €35", side: "left", role: "assistant", className: 'lark' },
{ text: "Check with local firms", side: "right", role: "user", className: 'lark' },
{ text: "Drafting email. Translating", side: "left", tone: "info", role: "assistant", className: 'lark'},
{ text: "Great, I’ve now received three quotes for your Istanbul transfer.\n\n1. Welcome Pickups – €29 (approx £25)\n2. Rento Transfer – $40 (approx £32)\n3. Haqqi Tours – $45 (approx £36)\n4. Al’s Taxi – €45 (approx £38)\n\nWelcome Pickups is the most competitive. Shall I book them now?", side: "left", role: "assistant", className: 'lark' },
{ text: "Yes please", side: "right", role: "user", className: 'lark' },
{ text: "Creating human supported task", side: "left", tone: "info", role: "assistant", className: 'lark'},
{ text: "Travel sorted!", side: "left", role: "assistant", className: 'lark', stickerSrc: crmSticker.src, stickerAlt: "CRM sticker", }
]
},
];

---



<Layout title="Dream - The assistant you’ve always been promised">
  

  <Navigation />
  <header class="hero-home index-hero">
    <div class="hero-elements main-content">
      <section class="header-text">
        <aside class="ticker-badge">First round hired. Secure your space</aside>
        <h1 class="page-title">
          The assistant you’ve always been promised
        </h1>
        <p>High-performing AI assistants that own the work from start to finish.</p>
        <div class="actions hero-actions">
          <Button target="" data-open-modal="mailing-list-modal">Join the waitlist <fragment set:html={ArrowCircle}/></Button>
        </div>
        <Image class="hero-statue" src={salesStatue} alt="A pale white statue of an assistant" width={540} height={900}/>
      </section>
    </div>
  </header>
  <main>
    <section class="content-panels">
      <article>
        <h4>Real world assistants</h4>
        <h2>AI assistants who act, not ask</h2>
        <p>Deployed with human-in-the-loop oversight, your assistant owns outcomes end-to-end.</p>
      </article>
      <ChatCarousel slides={slides} auto={true} />
    </section>

    <section class="content-panels">
      <article>
      <h4>What makes them different?</h4>
      <h2>Dream's assistants</h2>
      </article>
      
      
      <div class="sticker-host">
      
        <div class="assistant-features">
          <div class="content-box">
            <img
            class="sticker"
            src={featureSticker1.src}
            alt=""
            draggable="false"
            loading="eager"
            decoding="async"
            style="left: 50%; top: -5%; width: 256px;"
            data-sticker
          />
            <h5>Work inside your systems</h5>
            <p>They don’t draft. They do. Emails sent. Meetings booked. CRM updated.</p>
            </div>
            
            
            <div class="content-box">
              <img
              class="sticker"
              src={featureSticker2.src}
              alt=""
              draggable="false"
              loading="eager"
              decoding="async"
              style="left: 50%; top: -5%; width: 256px;"
              data-sticker
            />
            <h5>Deploy humans on demand</h5>
            <p>When AI isn’t enough, they spin up people. Calls made. Forms filled. Deals progressed.</p>
            </div>
            
            
            <div class="content-box">
              <img
              class="sticker"
              src={featureSticker3.src}
              alt=""
              draggable="false"
              loading="eager"
              decoding="async"
              style="left: 50%; top: -5%; width: 256px;"
              data-sticker
            />
            <h5>Remember what matters</h5>
            <p>One brain across inbox, calendar, travel, and sales. No context lost. No threads dropped.</p>
            </div>
            
            
            <div class="content-box">
              <img
              class="sticker"
              src={featureSticker4.src}
              alt=""
              draggable="false"
              loading="eager"
              decoding="async"
              style="left: 50%; top: -5%; width: 256px;"
              data-sticker
            />
            <h5>Take ownership</h5>
            <p>You set the goal. They take it from there. From first action to final result.</p>
            </div>
        </div>
      
      
      </div>
      </section>

    <section class="content-panels centre-title">
      <article>
        <h4>It's not choosing, it's hiring</h4>
        <h2>The best assistant you'll never meet</h2>
      </article>
      <div class="sticker-host agent-choice">
        <section class="content-panels agent-panels">
          <!-- Personal Assistant -->
          <article class="agent-block">
          <div class="agent-copy">
          <div class="agent-header">
          <h3>Your Personal Assistant</h3>
          <p class="agent-lede">
           Offload your admin. Never worry about an email, calendar or phone call again, your PA handles it all.
          </p>
          </div>
          
          
          <div class="agent-skills conversation-box empty-box">
            <p>
              I quietly run your day — inbox, calendar, travel, projects — as one continuous picture. Things get handled before they become problems.
              </p>
              <p>
              I already know the context, booking and planning your meetings, travel, and meals based on what you like.
              </p>
              <p>
              Calm, organised, always a step ahead.
              </p>
          </div>
          
          
          <div class="agent-cta">
            <Button target="" data-open-modal="mailing-list-modal">Join the waitlist <fragment set:html={ArrowCircle}/></Button>
          </div>
          </div>
          
          
          <div class="agent-media">
            <Image src={personalStatus} alt="A pale white status of an assistant" width={540} height={900}/>
          </div>
          </article>
          
          
          <!-- Sales Manager -->
          <article class="agent-block">
          <div class="agent-copy">
          <div class="agent-header">
          <h3>Your Sales Manager</h3>
          <p class="agent-lede">
           Your first sales hire. Equally capable running outbound campaigns as they are at advising on sales strategy.
          </p>
          </div>
          
          
          <div class="agent-skills conversation-box empty-box">
            <p>
              I run your outbound engine — finding prospects, launching campaigns, and keeping pipeline moving across email and social.
              </p>
              <p>
              I read every signal, surface hot leads, and deploy human callers to seal the deal on social, or with a call.
              </p>
              <p>
              Relentless about momentum. Focused on revenue.
              </p>
        </div>
          
          
          <div class="agent-cta">
            <Button target="" data-open-modal="mailing-list-modal">Join the waitlist <fragment set:html={ArrowCircle}/></Button>
          </div>
          </div>
          
          
          <div class="agent-media">
            <Image src={salesStatue} alt="A pale white status of an assistant" width={540} height={900}/>
          </div>
          </article>
          </section>
      </div>
    </section>
  </main>
    
<Footer />

<Modal id="mailing-list-modal" closeLabel="Close">
  <h2 slot="title">What assistants do you need?</h2>
  <div class="modal-form">
    <!-- Form view -->
    <form id="contactForm" class="webform" novalidate>
      <!-- honeypot -->
      <input type="text" name="address" tabindex="-1" autocomplete="off" hidden />

      <fieldset class="dreamie-radio-group">      
        <div class="radio-option fancy-option">
          <input type="checkbox" id="sales" name="dreamie" value="Head of Sales" />
          <label for="sales">
            <div class="fancy-option-inner">
            <span class="assistant-title">Grow my<br/> business</span>
            <span>Sales Manager</span>
            <Button class="button small secondary">Add <span>Sales Manager</span> <ArrowCircleDark /></Button>
          </div>
          </label>
        </div>
        <div class="radio-option fancy-option">
            <input type="checkbox" id="personal-assistant" name="dreamie" value="Personal Assistant" />
          <label for="personal-assistant">
            <div class="fancy-option-inner">

            <span class="assistant-title">Run my<br/> life</span>
            <span>Personal Assistant</span>
            <Button class="button small secondary">Add <span>Personal Assistant</span> <ArrowCircleDark /></Button>
          </div>
          </label>
        </div>
        <!-- <div class="radio-option">
          <input type="checkbox" id="finance" name="dreamie" value="Finance Manager" />
          <label for="finance">Finance Manager</label>
        </div>
        <div class="radio-option">
          <input type="checkbox" id="marketing" name="dreamie" value="Head of Marketing" />
          <label for="marketing">Head of Marketing</label>
        </div>
        <div class="radio-option">
          <input type="checkbox" id="cs" name="dreamie" value="Customer Service Manager" />
          <label for="cs">Customer Service Manager</label>
        </div>
        <div class="radio-option">
          <input type="checkbox" id="other" name="dreamie" value="Other" />
          <label for="other">Other</label>
        </div> -->
      </fieldset>
      <label>
        Name
        <input type="text" name="name" autocomplete="name" required />
      </label>

      <label>
        Email
        <input type="email" name="email" autocomplete="email" required />
      </label>

      <label>
        Company name
        <input type="text" name="company" autocomplete="organization" required/>
      </label>

      <label>
        Phone number
        <input type="tel" name="phone" autocomplete="tel" inputmode="tel" aria-describedby="phoneHelp" required/>
      </label>
      <p id="phoneHelp" class="visually-hidden">Include country code if outside the UK.</p>

      

      <button type="submit" class="button primary" id="submitBtn" aria-live="polite">
        Join the waitlist for the next round
      </button>

      <p id="formStatus" class="form-status" role="status" aria-live="polite"></p>
    </form>

    <!-- Success view (hidden until success) -->
    <div id="successView" class="success-view" hidden>
      <h4 id="successHeading">Thanks — you're on the list</h4>
      <p>While you’re here, follow us on LinkedIn</p>
      <ul class="success-links">
        <li><a href="https://www.linkedin.com/company/dream-ai-employees">Dream on LinkedIn</a></li>
      </ul>

      <div class="success-actions">
        <button type="button" class="button" data-close-modal>Close</button>
      </div>
    </div>
  </div>

  <script is:inline>
    (function () {
      // Prevent duplicate bindings if this script is included twice
      if (window.__hsMailingInit) return;
      window.__hsMailingInit = true;
  
      const PORTAL_ID = "49000459";
      const FORM_GUID = "4c792f29-f1da-4d96-9151-126ad0262902";
      const HS_URL = `https://api.hsforms.com/submissions/v3/integration/submit/${PORTAL_ID}/${FORM_GUID}`;
  
      const modal       = document.getElementById('mailing-list-modal');
      const form        = modal?.querySelector('#contactForm');
      const btn         = modal?.querySelector('#submitBtn');
      const statusElm   = modal?.querySelector('#formStatus');
      const successView = modal?.querySelector('#successView');
  
      if (!form) return;
      if (form.dataset.bound === '1') return;
      form.dataset.bound = '1';
  
      const getCookie = (name) =>
        document.cookie.split('; ').find(c => c.startsWith(name + '='))?.split('=')[1];
  
      const setLoading = (loading) => {
        if (!btn) return;
        btn.disabled = loading;
        btn.dataset.originalLabel ??= btn.textContent;
        btn.textContent = loading ? 'Sending…' : btn.dataset.originalLabel;
      };
  
      const splitName = (full) => {
        const s = (full || '').trim().replace(/\s+/g, ' ');
        if (!s) return { first: '', last: '' };
        const parts = s.split(' ');
        if (parts.length === 1) return { first: parts[0], last: '' };
        return { first: parts.slice(0, -1).join(' '), last: parts[parts.length - 1] };
      };
  
      // Map checkbox label/value -> HubSpot CRM option value (from your HS form)
      const OPTION_MAP = {
        'Personal Assistant':        'L6cGUyY3rxjbrVhObJdhj',
        'Head of Sales':             'heWA2aiKPXyI4gZmUDUmF',   // note: I4
        'Head of Marketing':         'oqS6sVZIgJPH0sSj37WLH',
        'Customer Services Manager': 'Ky7KhJjSBxEwocMYR8UOf',
        'Finance Manager':           'zToAvy_nDQn8MCqsJHTtv',
        'Something else':            'gRPuHuaxPur2_WQovppri'
      };
  
      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        if (statusElm) statusElm.textContent = '';
        // honeypot
        if (form.address?.value?.trim()) return;
  
        setLoading(true);
  
        try {
          const fd = new FormData(form);
          const fullName = (fd.get('name')  || '').toString().trim();
          const email    = (fd.get('email') || '').toString().trim();
          const company  = (fd.get('company') || '').toString().trim();
          const phone    = (fd.get('phone')   || '').toString().trim();
  
          // Collect all checked checkboxes named "dreamie" and map to CRM values
          const selected = Array.from(form.querySelectorAll('input[name="dreamie"]:checked'))
            .map(i => OPTION_MAP[i.value])
            .filter(Boolean);
  
          if (selected.length === 0) {
            if (statusElm) statusElm.textContent = 'Please pick at least one employee.';
            setLoading(false);
            return;
          }
  
          // HubSpot expects semicolon-separated internal option values
          const whichEmployeesValue = selected.join(';');
  
          const { first, last } = splitName(fullName);
  
          const fields = [
            { name: 'email', value: email },
            { name: 'firstname', value: first },
            { name: 'lastname',  value: last },
            { name: 'which_employees_', value: whichEmployeesValue },
            { name: 'company', value: company },
            { name: 'phone',   value: phone },
          ].filter(f => f.value !== '');
  
          const context = {
            hutk: getCookie('hubspotutk') || undefined,
            pageUri: window.location.href,
            pageName: document.title
          };
  
          const res = await fetch(HS_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ fields, context })
          });
  
          if (!res.ok) throw new Error('Bad response');
  
          form.hidden = true;
          if (successView) successView.hidden = false;
  
          const heading = successView?.querySelector('#successHeading');
          if (heading) {
            heading.setAttribute('tabindex', '-1');
            heading.focus({ preventScroll: true });
            setTimeout(() => heading.removeAttribute('tabindex'), 100);
          }
          form.reset();
        } catch {
          if (statusElm) statusElm.textContent = 'Something went wrong. Please try again.';
        } finally {
          setLoading(false);
        }
      });
    })();
  </script>
  
  <script>
  (() => {
  let active = null;
  let startX = 0, startY = 0;
  let startDX = 0, startDY = 0;
  let z = 1;

  const px = (n) => `${n}px`;
  const parsePx = (v) => (v && v.endsWith("px") ? parseFloat(v) : 0);

  function getSticker(e) {
    return e.target.closest(".sticker");
  }

  function onDown(e) {
    const el = getSticker(e);
    if (!el) return;

    active = el;
    active.style.zIndex = String(++z);

    // pointer start
    startX = e.clientX;
    startY = e.clientY;

    // current offsets (from inline style or computed)
    const cs = getComputedStyle(active);
    startDX = parsePx(cs.getPropertyValue("--dx").trim());
    startDY = parsePx(cs.getPropertyValue("--dy").trim());

    active.setPointerCapture(e.pointerId);
    e.preventDefault();
  }

  function onMove(e) {
    if (!active) return;

    const dx = startDX + (e.clientX - startX);
    const dy = startDY + (e.clientY - startY);

    active.style.setProperty("--dx", px(dx));
    active.style.setProperty("--dy", px(dy));
  }

  function onUp(e) {
    if (!active) return;
    try { active.releasePointerCapture(e.pointerId); } catch {}
    active = null;
  }

  document.addEventListener("pointerdown", onDown);
  document.addEventListener("pointermove", onMove);
  document.addEventListener("pointerup", onUp);
  document.addEventListener("pointercancel", onUp);
})();
  </script>
  
  <script>
    (function () {
      // Your current markup: .customer-quote is the carousel root
      const root = document.querySelector('.customer-quote');
      if (!root) return;
  
      const track = root.querySelector('.quote-track');
      const slides = Array.from(root.querySelectorAll('.quote-slide'));
      if (!track || !slides.length) return;
  
      // Dots are OUTSIDE .customer-quote in your HTML, so find them as a sibling first
      const dotsWrap =
        root.parentElement?.querySelector(':scope > .quote-dots') ||
        root.nextElementSibling?.classList?.contains('quote-dots')
          ? root.nextElementSibling
          : document.querySelector('.quote-dots');
  
      if (!dotsWrap) return;
  
      // Build dots (reset first)
      dotsWrap.innerHTML = '';
      slides.forEach((_, i) => {
        const b = document.createElement('button');
        b.type = 'button';
        b.setAttribute('aria-label', `Go to quote ${i + 1}`);
        b.addEventListener('click', () => {
          goTo(i, true);
          resetCycle();
        });
        dotsWrap.appendChild(b);
      });
      const dots = Array.from(dotsWrap.querySelectorAll('button'));
  
      let idx = 0;
      const autoMs = 6000;
      let timer = null;
      let programmaticScroll = false;
  
      function updateDots(i) {
        dots.forEach((d, k) =>
          d.setAttribute('aria-current', k === i ? 'true' : 'false')
        );
      }
  
      function goTo(i, smooth = true) {
        idx = (i + slides.length) % slides.length;
        programmaticScroll = true;
        track.scrollTo({
          left: slides[idx].offsetLeft,
          behavior: smooth ? 'smooth' : 'auto',
        });
        updateDots(idx);
      }
  
      // IntersectionObserver keeps idx in sync if user drags
      const io = new IntersectionObserver(
        (entries) => {
          entries.forEach((e) => {
            if (e.isIntersecting && e.intersectionRatio > 0.6) {
              const n = slides.indexOf(e.target);
              if (n !== -1) {
                idx = n;
                updateDots(idx);
              }
            }
          });
        },
        { root: track, threshold: [0.6] }
      );
      slides.forEach((s) => io.observe(s));
  
      function scheduleNext() {
        clearNext();
        timer = window.setTimeout(() => {
          goTo(idx + 1, true);
          waitForScrollEnd().then(() => {
            programmaticScroll = false;
            scheduleNext();
          });
        }, autoMs);
      }
  
      function clearNext() {
        if (timer) clearTimeout(timer);
        timer = null;
      }
  
      function resetCycle() {
        clearNext();
        scheduleNext();
      }
  
      function waitForScrollEnd() {
        if ('onscrollend' in window) {
          return new Promise((resolve) => {
            const handler = () => {
              track.removeEventListener('scrollend', handler);
              resolve();
            };
            track.addEventListener('scrollend', handler, { once: true });
          });
        }
        return new Promise((resolve) => {
          let t;
          const onScroll = () => {
            if (!programmaticScroll) return;
            clearTimeout(t);
            t = window.setTimeout(() => {
              track.removeEventListener('scroll', onScroll);
              resolve();
            }, 150);
          };
          track.addEventListener('scroll', onScroll, { passive: true });
          onScroll();
        });
      }
  
      // User manual scroll: reset cycle after they stop
      let manualDebounce;
      track.addEventListener(
        'scroll',
        () => {
          if (programmaticScroll) return;
          clearNext();
          clearTimeout(manualDebounce);
          manualDebounce = window.setTimeout(() => {
            scheduleNext();
          }, 800);
        },
        { passive: true }
      );
  
      // Init
      goTo(0, false);
      programmaticScroll = false;
      scheduleNext();
    })();
  </script>
</Modal>

</Layout>
