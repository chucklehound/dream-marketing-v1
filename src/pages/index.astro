---
import Layout from "../layouts/Layout.astro";

import { Image } from 'astro:assets';

import Button from "../components/Button.astro";
import Navigation from "../components/Navigation.astro";
import Footer from "../components/Footer.astro";

import chats1 from '/src/img/home-chats.png';
import chats2 from '/src/img/home-chats-2.png';
import chats3 from '/src/img/home-chats-3.png';

import card1 from '/src/img/carousel-1--phone.png';
import card2 from '/src/img/carousel-2--whatsapp.png';
import card3 from '/src/img/carousel-3--update.png';
import card4 from '/src/img/carousel-4--success.png';

import quoteLogo from '/src/img/givewheel-logo.png';
import quoteLogojdi from '/src/img/justdoughit-logo.png';
import quoteLogohol from '/src/img/holibob-logo.png';

import ctaDreamies from '/src/img/end-cta-guys.png';

import DreamieCarousel from '../components/DreamieCarousel.jsx';

import HireGuyBlock from "../components/HireGuyBlock.astro";

import Modal from "../components/Modal.astro";

// Import dreamie1 to dreamie25 as an array
import dreamie1 from '/src/img/hero-dreamies/dreamie-1.png';
import dreamie2 from '/src/img/hero-dreamies/dreamie-2.png';
import dreamie3 from '/src/img/hero-dreamies/dreamie-3.png';
import dreamie4 from '/src/img/hero-dreamies/dreamie-4.png';
import dreamie5 from '/src/img/hero-dreamies/dreamie-5.png';
import dreamie6 from '/src/img/hero-dreamies/dreamie-6.png';
import dreamie7 from '/src/img/hero-dreamies/dreamie-7.png';
import dreamie8 from '/src/img/hero-dreamies/dreamie-8.png';
import dreamie9 from '/src/img/hero-dreamies/dreamie-9.png';
import dreamie10 from '/src/img/hero-dreamies/dreamie-10.png';
import dreamie11 from '/src/img/hero-dreamies/dreamie-11.png';
import dreamie12 from '/src/img/hero-dreamies/dreamie-12.png';
import dreamie13 from '/src/img/hero-dreamies/dreamie-13.png';
import dreamie14 from '/src/img/hero-dreamies/dreamie-14.png';
import dreamie15 from '/src/img/hero-dreamies/dreamie-15.png';
import dreamie16 from '/src/img/hero-dreamies/dreamie-16.png';
import dreamie17 from '/src/img/hero-dreamies/dreamie-17.png';
import dreamie18 from '/src/img/hero-dreamies/dreamie-18.png';
import dreamie19 from '/src/img/hero-dreamies/dreamie-19.png';
import dreamie20 from '/src/img/hero-dreamies/dreamie-20.png';
import dreamie21 from '/src/img/hero-dreamies/dreamie-21.png';
import dreamie22 from '/src/img/hero-dreamies/dreamie-22.png';
import dreamie23 from '/src/img/hero-dreamies/dreamie-23.png';
import dreamie24 from '/src/img/hero-dreamies/dreamie-24.png';
import dreamie25 from '/src/img/hero-dreamies/dreamie-25.png';

const dreamieImages = [
  dreamie1, dreamie2, dreamie3, dreamie4, dreamie5,
  dreamie6, dreamie7, dreamie8, dreamie9, dreamie10,
  dreamie11, dreamie12, dreamie13, dreamie14, dreamie15,
  dreamie16, dreamie17, dreamie18, dreamie19, dreamie20,
  dreamie21, dreamie22, dreamie23, dreamie24, dreamie25
];

// Just return an array of src strings now
const images = dreamieImages.map((img) => img.src);

const messages = [
  // cycle 1
  { name: "Ben",     type: "Head of Marketing",  text: "overseeing the build of the company website" },   // start a business
  { name: "Tina",    type: "Head of Sales",      text: "researching and building target company lists" }, // enter new markets
  { name: "Ethan",   type: "Personal Assistant", text: "managing incoming phone calls" },                 // save an hour
  { name: "Sophia",  type: "Head of Sales",      text: "sending contracts out for signature" },           // handle more customers
  { name: "Anna",    type: "Head of Finance",    text: "chasing up missing receipts and invoices" },      // get paid on time

  // cycle 2
  { name: "Chris",   type: "Head of Marketing",  text: "creating and managing social media content" },
  { name: "Alex",    type: "Head of Sales",      text: "testing and refining outreach campaigns" },
  { name: "Nina",    type: "Personal Assistant", text: "arranging travel for frequent business trips" },
  { name: "Pablo",   type: "Personal Assistant", text: "handling and directing phone enquiries" },
  { name: "Charlie", type: "Head of Finance",    text: "following up on missing financial documents" },

  // cycle 3
  { name: "Leo",     type: "Head of Marketing",  text: "planning and creating social media posts" },
  { name: "Omar",    type: "Head of Marketing",  text: "selecting and preparing company lists for campaigns" },
  { name: "Kara",    type: "Personal Assistant", text: "booking complex travel itineraries" },
  { name: "Sam",     type: "Personal Assistant", text: "following up quickly with every new enquiry" },   // tweaked
  { name: "Priya",   type: "Head of Finance",    text: "tracking down outstanding receipts and invoices" },

  // cycle 4
  { name: "Grace",   type: "Head of Marketing",  text: "setting up your first ad campaign" },             // tweaked
  { name: "Jack",    type: "Head of Sales",      text: "identifying prospects in adjacent markets" },
  { name: "Philipp", type: "Personal Assistant", text: "extracting and organising receipts from emails" },
  { name: "Liam",    type: "Personal Assistant", text: "managing onboarding paperwork for new customers" }, // tweaked
  { name: "Hugo",    type: "Head of Finance",    text: "ensuring all receipts and invoices are accounted for" },

  // cycle 5
  { name: "Jordan",  type: "Personal Assistant", text: "organising your business calendar from day one" },  // tweaked
  { name: "Olivia",  type: "Head of Sales",      text: "opening conversations in new regions" },
  { name: "Isla",    type: "Personal Assistant", text: "organising receipts and uploading them to accounts" },
  { name: "Noah",    type: "Personal Assistant", text: "keeping all customer conversations organised in one place" }, // tweaked
  { name: "Maya",    type: "Head of Finance",    text: "following up on incomplete financial records" }
];

import Carousel from '../components/Carousel.astro';

const contentBlocks = [
  {
    image: card1,
    title: 'No complicated apps to learn, starting is as simple as making a call.',
    subtitle: 'Be the first to hire',
    ctaText: 'Get notified',
  },
  {
    image: card2,
    title: 'Make plans with a message, and leave your Dream team to handle the hard work.',
    subtitle: 'Be the first to hire',
    ctaText: 'Get notified',
  },
  {
    image: card3,
    title: 'Grow your business without growing your workload. Your team handles the hard work, you take the call.',
    subtitle: 'Be the first to hire',
    ctaText: 'Get notified',
  },
  {
    image: card4,
    title: 'Priced to get your business started, built to make it succeed.',
    subtitle: 'Be the first to hire',
    ctaText: 'Get notified',
  },
];
---

<Layout title="Dream - AI that grows your business">
  <Navigation />
  <header class="hero-home index-hero">
    <div class="hero-elements main-content">
      <section class="header-image home-hero">
        <div class="ticker-window">
          <DreamieCarousel images={images} messages={messages} client:load />
        </div>
      </section>
      <section class="header-text">
        <h1 class="page-title">
          AI employees that help you
          <span id="rotating-text">difficult markets</span>
        </h1>
      </section>
      <div class="actions">
        <Button
        target=""
        variant="primary"
        size="large"
        data-open-modal="mailing-list-modal"
        label="">Be the first to hire</Button>
      </div>
    </div>
  </header>
  <main>
    <HireGuyBlock />
    <section class="main-content">
      <article class="content-container full-width">
        <div class="content-title">
          <h2>Work is hard. <br/>So we made <span class="highlight-title">Dream simple</span></h2>
          <p>Dream keeps things simple on the surface, while powerful AI managers handle the hard stuff.</p>
        </div>
        <Carousel items={contentBlocks} />
      </article>
    </section>
    <section class="main-content">
      <article class="full-width-contrast promo-home promo-human">
        <div class="content-container">
          <div class="content-title">
            <h2>Dream is your 24/7 <br/><span class="highlight-title">AI powered</span> workforce</h2>
            <p>The employees that you need to reach your business goals, <br/>working for you every hour of every day.</p>
          </div>
        </div>
      </article>
    </section>
    <section class="main-content contain-on-mobile">
      <article class="content-container">
        <div class="breakout rotating-chats">
          <div class="block" style={`background-image: url(${chats1.src});`}></div>
          <div class="block" style={`background-image: url(${chats2.src});`}></div>
          <div class="block" style={`background-image: url(${chats3.src});`}></div>
        </div>
        <div class="content-title">
          <h2>Built to <span class="highlight-title">handle the things</span> <br/>you don't want to</h2>
          <p>Your AI employees are tailored for your business - they learn what you do, how you speak & how you work. </p>
        </div>
      </article>
    </section>
    <section class="customer-quote main-content"> 
      <article class="quote-body"> 
        <div class="content-title">
          <h2>AI that works <span class="highlight-title">for everyone</span></h2>
        </div>
    
        <!-- Only this viewport/track rotates -->
        <div class="quote-viewport">
          <div class="quote-track" role="group" aria-roledescription="carousel" aria-label="Customer quotes">
    
            <!-- Slide 1 -->
            <div class="quote-slide">
              <blockquote>
                <p>“Dream has been a game-changer for GiveWheel. Their Sales Manager is like a second brain—it finds the right companies, reaches out, follows up, and keeps leads warm. We’re now top of mind for corporate charity campaigns, without stretching our team. It’s taken us from reactive to proactive, without hiring.”</p>
                <cite>
                  <span>Charlie Hart, Co‑founder at Givewheel</span>
                  <Image
                    src={quoteLogo}
                    alt="The logo for Givewheel"
                    width={364}
                    height={96}
                    format="webp"
                  />
                </cite>
              </blockquote>
            </div>
    
            <!-- Slide 2 -->
            <div class="quote-slide">
              <blockquote>
                <p>“Dream has transformed Just Dough It from a side hustle into a full-time business. Their Head of Sales does the outreach I’d never have had time for—emailing venues across the country, keeping the pipeline full, and following up automatically. Every customer we’ve won has come through Dream, and it’s freed me to focus on growing the business instead of chasing leads.”</p>
                <cite><span>Will Cowley, Owner at Just Dough It</span></cite>
                <Image
                  src={quoteLogojdi}
                  alt="The logo for Just Dough It"
                  width={480}
                  height={56}
                  format="webp"
                />
              </blockquote>
            </div>
    
            <!-- Slide 3 -->
            <div class="quote-slide">
              <blockquote>
                <p>“Dream has been a huge growth driver for Holibob. Our Head of Sales runs all our outreach—finding the right partners, reaching out, and booking calls—so we just show up ready to close. It even opened up new sectors like airlines that we’d never had time to target before. It’s like having a dedicated sales team on autopilot, without the overhead.”</p>
                <cite><span>Angus Hardy, Co-founder at Holibob</span></cite>
                <Image
                  src={quoteLogohol}
                  alt="The logo for Holibob"
                  width={408}
                  height={96}
                  format="webp"
                />
              </blockquote>
            </div>
    
          </div>
        </div>
    
        <!-- Dots live INSIDE the box -->
        <div class="quote-dots" aria-label="Slide pagination"></div>
      </article> 
    </section>
    
    
<section class="final-cta"> 
  <article class="main-content cta-container"> 
    <Image
      src={ctaDreamies}
      alt="The 5 Dreamies of Dream - Business, Sales, Marketing, Finance, and Design"
      width={1248}
      height={452}
      format="webp"
    />
    <div class="content-title">
      <h2><span class="highlight-title">Grow your business </span><br/>with Dream</h2>
    </div>
    <Button
        target=""
        variant="primary"
        size="medium"
        data-open-modal="mailing-list-modal"
        label="">Be the first to hire</Button>
          </article> 
    </section>
</main>
    
<Footer />

<Modal id="mailing-list-modal" closeLabel="Close">
  <h2 slot="title">Hire your own Dreamies</h2>
  <p>We're getting our Dreamies ready to onboard, get an instant notification when they're ready to hire.</p>

  <div class="modal-form">
    <!-- Form view -->
    <form id="contactForm" class="webform" novalidate>
      <!-- honeypot -->
      <input type="text" name="address" tabindex="-1" autocomplete="off" hidden />

      <label>
        Name
        <input type="text" name="name" required />
      </label>

      <label>
        Email
        <input type="email" name="email" required />
      </label>

      <fieldset class="dreamie-radio-group">
        <legend>Which employee are you most excited by?</legend>
        <div class="radio-option">
          <input type="radio" id="finance" name="dreamie" value="Finance Manager" required />
          <label for="finance">Personal Assistant</label>
        </div>
        <div class="radio-option">
          <input type="radio" id="finance" name="dreamie" value="Finance Manager" required />
          <label for="finance">Head of Sales</label>
        </div>
        <div class="radio-option">
          <input type="radio" id="finance" name="dreamie" value="Finance Manager" required />
          <label for="finance">Finance Manager</label>
        </div>
        <div class="radio-option">
          <input type="radio" id="marketing" name="dreamie" value="Head of Marketing" />
          <label for="marketing">Head of Marketing</label>
        </div>
        <div class="radio-option">
          <input type="radio" id="cs" name="dreamie" value="Customer Service Manager" />
          <label for="cs">Customer Service Manager</label>
        </div>
        <div class="radio-option">
          <input type="radio" id="other" name="dreamie" value="Other" />
          <label for="other">Other</label>
        </div>
      </fieldset>

      <button type="submit" class="button secondary" id="submitBtn" aria-live="polite">
        Get updates
      </button>

      <p id="formStatus" class="form-status" role="status" aria-live="polite"></p>
    </form>

    <!-- Success view (hidden until success) -->
    <div id="successView" class="success-view" hidden>
      <h4 id="successHeading">Thanks — you're on the list</h4>
      <p>While you’re here, follow us on LinkedIn</p>
      <ul class="success-links">
        <li><a href="https://www.linkedin.com/company/dream-ai-employees">Dream on LinkedIn</a></li>
      </ul>

      <div class="success-actions">
        <button type="button" class="button" data-close-modal>Close</button>
      </div>
    </div>
  </div>

  <script is:inline>
    (function () {
      const PORTAL_ID = "49000459";
      const FORM_GUID = "4c792f29-f1da-4d96-9151-126ad0262902";
      const HS_URL = `https://api.hsforms.com/submissions/v3/integration/submit/${PORTAL_ID}/${FORM_GUID}`;
    
      const modal       = document.getElementById('mailing-list-modal');
      const form        = modal.querySelector('#contactForm');
      const btn         = modal.querySelector('#submitBtn');
      const statusElm   = modal.querySelector('#formStatus');
      const successView = modal.querySelector('#successView');
    
      const getCookie = (name) =>
        document.cookie.split('; ').find(c => c.startsWith(name + '='))?.split('=')[1];
    
      const setLoading = (loading) => {
        if (!btn) return;
        btn.disabled = loading;
        btn.dataset.originalLabel ??= btn.textContent;
        btn.textContent = loading ? 'Sending…' : btn.dataset.originalLabel;
      };
    
      const splitName = (full) => {
        const parts = (full || '').trim().split(/\s+/);
        if (!parts.length) return { first: '', last: '' };
        if (parts.length === 1) return { first: parts[0], last: '' };
        return { first: parts.slice(0, -1).join(' '), last: parts.at(-1) };
      };
    
      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        statusElm.textContent = '';
        if (form.address?.value?.trim()) return; // honeypot
    
        setLoading(true);
    
        const fd = new FormData(form);
        const email   = (fd.get('email')   || '').toString().trim();
        const name    = (fd.get('name')    || '').toString().trim();
        const dreamie = (fd.get('dreamie') || '').toString().trim();
    
        const { first, last } = splitName(name);
    
        // Use HubSpot internal property names
        const fields = [
          { name: 'email', value: email },
          { name: 'firstname', value: first },
          { name: 'lastname',  value: last },
          { name: 'which_employee_are_you_most_excited_by_', value: dreamie },
        ];
    
        const context = {
          hutk: getCookie('hubspotutk') || undefined,
          pageUri: window.location.href,
          pageName: document.title
        };
    
        try {
          const res = await fetch(HS_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ fields, context })
          });
          if (!res.ok) throw new Error('Bad response');
    
          form.hidden = true;
          successView.hidden = false;
    
          const heading = successView.querySelector('#successHeading');
          if (heading) {
            heading.setAttribute('tabindex', '-1');
            heading.focus({ preventScroll: true });
            setTimeout(() => heading.removeAttribute('tabindex'), 100);
          }
          form.reset();
        } catch {
          statusElm.textContent = 'Something went wrong. Please try again.';
        } finally {
          setLoading(false);
        }
      });
    })();
    </script>
    
    
    
</Modal>

<script>
  (function startSharedTicker(period = 5000) {
    const w = window as any; // cast to any to silence TS about custom props
    if (w.__dreamTickerStarted) return;
    w.__dreamTickerStarted = true;

    // Fire an initial tick so everything aligns immediately
    window.dispatchEvent(new CustomEvent("dream:tick"));

    let expected = Date.now() + period;
    function tick() {
      window.dispatchEvent(new CustomEvent("dream:tick"));
      const drift = Date.now() - expected;
      expected += period;
      setTimeout(tick, Math.max(0, period - drift));
    }
    setTimeout(tick, period);
  })();
</script>


<style>
  #rotating-text {
    transition: opacity 0.4s; /* must match FADE in React */
    opacity: 0;
  }
</style>

<span id="rotating-text" aria-live="polite"></span>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const el = document.getElementById("rotating-text");
    const texts = [
      "start a business",
      "enter new markets",
      "save an hour every day",
      "handle more customers",
      "get paid on time"
    ];
    let i = 0;
    const FADE = 400; // ms

    // Render first item immediately
    el.textContent = texts[i];
    el.style.opacity = "1";
    i = (i + 1) % texts.length;

    function advance() {
      el.style.opacity = "0";
      setTimeout(() => {
        el.textContent = texts[i];
        el.style.opacity = "1";
        i = (i + 1) % texts.length;
      }, FADE);
    }

    window.addEventListener("dream:tick", advance);
  });
</script>

  <!-- <script>
    document.addEventListener("DOMContentLoaded", () => {
      const rotatingTextElement = document.getElementById("rotating-text");
      const texts = [
        "start a business",
        "enter new markets",
        "save an hour every day",
        "handle more customers",
      ];
      let index = 0;

      function rotateText() {
        // Fade out
        rotatingTextElement.style.opacity = "0";

        setTimeout(() => {
          // Change text after fade out
          rotatingTextElement.textContent = texts[index];

          // Fade in
          rotatingTextElement.style.opacity = "1";

          // Move to next index, looping back to the start
          index = (index + 1) % texts.length;
        }, 200); // Adjust timing for fade-out before changing text

        // Repeat after 5 seconds
        setTimeout(rotateText, 5000);
      }

      // Start the rotation
      rotateText();
    });
  </script> -->




<script type="module">
  const target = document.querySelector('.promo-human');

  const observer = new IntersectionObserver(
    ([entry], observer) => {
      if (entry.isIntersecting) {
        target.classList.add('visible');
        observer.unobserve(target); // 🔥 Stop observing after first trigger
      }
    },
    {
      root: null,
      rootMargin: '0px',
      threshold: 0.4
    }
  );

  if (target) observer.observe(target);
</script>

<script>
  (function () {
    const root = document.querySelector('.customer-quote .quote-body');
    if (!root) return;
  
    const track = root.querySelector('.quote-track') as HTMLElement;
    const slides = Array.from(root.querySelectorAll('.quote-slide')) as HTMLElement[];
    const dotsWrap = root.querySelector('.quote-dots') as HTMLElement;
  
    // Build dots
    slides.forEach((_, i) => {
      const b = document.createElement('button');
      b.type = 'button';
      b.setAttribute('aria-label', `Go to quote ${i + 1}`);
      b.addEventListener('click', () => {
        goTo(i, true);
        resetCycle();
      });
      dotsWrap.appendChild(b);
    });
    const dots = Array.from(dotsWrap.querySelectorAll('button'));
  
    let idx = 0;
    let autoMs = 6000;
    let timer: number | null = null;
    let programmaticScroll = false;
  
    function updateDots(i: number) {
      dots.forEach((d, k) =>
        d.setAttribute('aria-current', k === i ? 'true' : 'false')
      );
    }
  
    function goTo(i: number, smooth = true) {
      idx = (i + slides.length) % slides.length;
      programmaticScroll = true;
      track.scrollTo({
        left: slides[idx].offsetLeft,
        behavior: smooth ? 'smooth' : 'auto',
      });
      updateDots(idx);
    }
  
    // IntersectionObserver keeps idx in sync if user drags
    const io = new IntersectionObserver(
      (entries) => {
        entries.forEach((e) => {
          if (e.isIntersecting && e.intersectionRatio > 0.6) {
            const n = slides.indexOf(e.target as HTMLElement);
            if (n !== -1) {
              idx = n;
              updateDots(idx);
            }
          }
        });
      },
      { root: track, threshold: [0.6] }
    );
    slides.forEach((s) => io.observe(s));
  
    // Autoplay with self-scheduling timeout
    function scheduleNext() {
      clearNext();
      timer = window.setTimeout(() => {
        goTo(idx + 1, true);
        waitForScrollEnd().then(() => {
          programmaticScroll = false;
          scheduleNext();
        });
      }, autoMs);
    }
    function clearNext() {
      if (timer) clearTimeout(timer);
      timer = null;
    }
    function resetCycle() {
      clearNext();
      scheduleNext();
    }
  
    // Wait until smooth scroll finishes before scheduling next tick
    function waitForScrollEnd(): Promise<void> {
      if ('onscrollend' in window) {
        return new Promise((resolve) => {
          const handler = () => {
            track.removeEventListener('scrollend', handler);
            resolve();
          };
          track.addEventListener('scrollend', handler, { once: true });
        });
      }
      return new Promise((resolve) => {
        let t: number;
        const onScroll = () => {
          if (!programmaticScroll) return;
          clearTimeout(t);
          t = window.setTimeout(() => {
            track.removeEventListener('scroll', onScroll);
            resolve();
          }, 150);
        };
        track.addEventListener('scroll', onScroll, { passive: true });
        onScroll();
      });
    }
  
    // User manual scroll: reset cycle after they stop
    let manualDebounce: number;
    track.addEventListener(
      'scroll',
      () => {
        if (programmaticScroll) return;
        clearNext();
        clearTimeout(manualDebounce);
        manualDebounce = window.setTimeout(() => {
          scheduleNext();
        }, 800);
      },
      { passive: true }
    );
  
    // Init
    goTo(0, false);
    programmaticScroll = false;
    scheduleNext();
  })();
  </script>
  
  
  
  
</Layout>
